"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.resolveExtensions = exports.loader = exports.item = void 0;
const bud_build_1 = require("@roots/bud-build");
const sass_dependency_1 = require("./sass.dependency");
/*
 * Webpack item factory
 *
 * @remarks
 * This imports the sass implementation (sass/sass)
 *
 * @param logger - Bud logger
 * @returns Promised Item
 *
 * @internal
 */
async function item(logger) {
    logger.await('configuring scss ruleset use item');
    const implementation = await (0, sass_dependency_1.importSassImplementation)(logger);
    const item = new bud_build_1.Item({
        loader: ({ build }) => build.loaders.sass,
        options: () => ({
            implementation,
            sourceMap: true,
        }),
    });
    logger.success('configuring scss ruleset use item');
    return item;
}
exports.item = item;
/**
 * Webpack loader factory
 *
 * @param logger - Bud logger
 * @returns sass-loader
 *
 * @internal
 */
function loader(logger) {
    logger.await('configuring scss loader');
    const loader = new bud_build_1.Loader(require.resolve('sass-loader'));
    logger.success('configuring scss loader');
    return loader;
}
exports.loader = loader;
/**
 * Resolve extensions callback
 *
 * @param extensions - current extensions value
 * @returns extensions + '.scss'
 *
 * @internal
 */
function resolveExtensions(extensions) {
    return [...new Set([...extensions, '.scss'])];
}
exports.resolveExtensions = resolveExtensions;
