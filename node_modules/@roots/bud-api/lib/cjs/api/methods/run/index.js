"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.run = void 0;
const run = async function () {
    const ctx = this;
    await ctx.extensions.processQueue();
    await ctx.api.processQueue();
    await ctx.hooks.filterAsync('event.run', async () => ctx);
    const isDev = ctx.isDevelopment &&
        ctx.server?.run &&
        ctx.store.is('server.middleware.hot', true);
    const development = async () => {
        await ctx.server.run();
    };
    const production = async () => {
        const compiler = await ctx.compiler.compile();
        compiler.run(ctx.compiler.callback);
    };
    isDev ? await development() : await production();
};
exports.run = run;
